{%  extends "base.html" %}


{% block content  %}

<head>
	<!-- Load plotly.js into the DOM -->
	<script src='https://cdn.plot.ly/plotly-latest.min.js'>
    </script>
</head>

<body>
<!-- Shows name of file currently in use at top of page-->
{% if error_message %} 
    <p style="color:red;"> You have not set any event log as input. Use "Event Data" tab to set an event log as input!</p>
{% else %}
    <p style="color:green;"> {{log_name}} is used as input.</p>
{% endif %}

<!-- Dropdown menu selections -->
<br>
<div class="row">
  <div class=" col-sm-6 col-md-7 col-lg-8">
    <form  name="choice" action="" method = "POST">
      {% csrf_token %}
        <p>X-axis:</p>
        <select name="xaxis_choice">
          {% for attr in attribute_list %}
            {% if attr ==  default_label_list.0 %}
              <option value="{{attr}}" selected>{{attr}}</option>
            {% else %}
              <option value="{{attr}}">{{attr}}</option>
            {% endif %}
          {% endfor %}
        </select>

        <p>Y-axis:</p>
        <select name="yaxis_choice">
          {% for attr in attribute_list %}
            {% if attr ==  default_label_list.1 %}
              <option value="{{attr}}" selected>{{attr}}</option>
            {% else %}
              <option value="{{attr}}">{{attr}}</option>
            {% endif %}
          {% endfor %}
        </select>

        <p>Color:</p>
        <select name="color_choice">
          <option selected hidden>Choose here</option>
          {% for attr in attribute_list %}
            <option value="{{attr}}">{{attr}}</option>
          {% endfor %}
        </select>

        <p>Shape:</p>
        <select name="shape_choice">
          <option selected hidden>Choose here</option>
          {% for attr in attribute_list %}
            <option value="{{attr}}">{{attr}}</option>
          {% endfor %}
        </select>

        <input style="margin-top: 10px;" data-toggle="tooltip" data-placement="top" title="Set as the input" type = "submit" class="btn btn-success" value = "Set" name= "setButton" id ='setButton' />

    </form>
      </div>
</div>
<br>
<div id="tester"></div>
<script> 
function drawDefault()
{
  var default_axis = {{ default_axis_list|safe }};
  var default_x = default_axis[0];
  var default_y = default_axis[1];
  var default_label = {{ default_label_list|safe}};
  var trace1 = {
    x: default_x,
    y: default_y,
    mode: 'markers',
    type: 'scatter',
    marker: { size: 12 }
  };

  var layout = {
    showlegend: false,
    xaxis: { type: 'category' },
    yaxis: { type: 'category',  automargin: true}
  };
  
  var data = [ trace1 ];

  Plotly.react("tester", data, layout)
}
</script>

<script>
function drawSomething(){
  var axis_values = {{axis_list|safe }};
  var x_values = axis_values[0];
  var y_values = axis_values[1];
  var trace1 = {
    x: x_values,//['a'],
    y: y_values,//['b'],
    mode: 'markers',
    type: 'scatter',
    marker: { size: 12 }
  };

  var layout = {
    showlegend: false,
    xaxis: { type: 'category' },
    yaxis: { type: 'category',  automargin: true}
  };
  
  var data = [ trace1 ];

  Plotly.react("tester", data, layout)
}
</script>


{% if default_try == False %}
  <p>Changed</p>
  <script>drawSomething();</script>
{% else %}
  <p>Default </p>
  <script>drawDefault();</script>
{% endif %}

</body>

    {% endblock %}
